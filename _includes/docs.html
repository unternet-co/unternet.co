---
layout: base
stylesheet: 'docs'
---

{% comment %} Find the current section based on the page URL {% endcomment %}
{% assign currentSection = "" %}
{% for section in docsNavigation.sections %}
  {% assign sectionPath = '/docs/' | append: section.slug | append: '/' %}
  {% if page.url contains sectionPath %}
    {% assign currentSection = section.name %}
    {% break %}
  {% endif %}
{% endfor %}
{% comment %} Fallback to Web Applets if no match {% endcomment %}
{% if currentSection == "" %}
  {% assign currentSection = "Web Applets" %}
{% endif %}

<main class="docs">
  <!-- Primary navigation - docs sections -->
  <nav class="docs-primary-nav">
    <ul>
      {% for section in docsNavigation.sections %}
      <li>
        <a href="{{ section.url }}" class="{% if currentSection == section.name %}active{% endif %}">{{ section.name }}</a>
      </li>
      {% endfor %}
    </ul>
  </nav>

  <!-- Main docs layout -->
  <div class="docs-main">
    <!-- Secondary navigation - sidebar for current section -->
    <nav class="docs-secondary-nav collapsed">
      <svg class="menu-icon" id="menu-button" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>
      </svg>
      
      
      {% assign sidebarNavigation = collections.all | eleventyNavigation: currentSection %}
      
      {% comment %} Filter navigation items to only show those belonging to the current section {% endcomment %}
      {% assign currentSectionSlug = "" %}
      {% for section in docsNavigation.sections %}
        {% if section.name == currentSection %}
          {% assign currentSectionSlug = section.slug %}
          {% break %}
        {% endif %}
      {% endfor %}
      
      {% assign filteredNavigation = "" | split: "" %}
      {% for item in sidebarNavigation %}
        {% assign shouldIncludeItem = false %}
        
        {% comment %} Include if item has URL in current section {% endcomment %}
        {% if item.url %}
          {% assign sectionPath = '/docs/' | append: currentSectionSlug | append: '/' %}
          {% if item.url contains sectionPath %}
            {% assign shouldIncludeItem = true %}
          {% endif %}
        {% endif %}
        
        {% comment %} Include if item has children in current section {% endcomment %}
        {% if item.children and item.children.size > 0 %}
          {% for child in item.children %}
            {% if child.url %}
              {% assign sectionPath = '/docs/' | append: currentSectionSlug | append: '/' %}
              {% if child.url contains sectionPath %}
                {% assign shouldIncludeItem = true %}
                {% break %}
              {% endif %}
            {% endif %}
          {% endfor %}
        {% endif %}
        
        {% if shouldIncludeItem %}
          {% assign filteredNavigation = filteredNavigation | push: item %}
        {% endif %}
      {% endfor %}
      
      <ul>
        {% for item in filteredNavigation %}
          {% if item.children and item.children.size > 0 %}
            {% comment %} Filter children to current section too {% endcomment %}
            {% assign filteredChildren = "" | split: "" %}
            {% for child in item.children %}
              {% if child.url contains sectionPath %}
                {% assign filteredChildren = filteredChildren | push: child %}
              {% endif %}
            {% endfor %}
            
            {% if filteredChildren.size > 0 %}
            <li>
              <h2>{{ item.key }}</h2>
              <ul>
                {% for child in filteredChildren %}
                  <li>
                    <a href="{{ child.url }}" class="{% if page.url == child.url %}active{% endif %}">{{ child.key }}</a>
                  </li>
                {% endfor %}
              </ul>
            </li>
            {% endif %}
          {% else %}
            <li>
              <a href="{{ item.url }}" class="{% if page.url == item.url %}active{% endif %}">{{ item.key }}</a>
            </li>
          {% endif %}
        {% endfor %}
      </ul>
    </nav>
    <!-- Main content area -->
    <article class="docs-content">
      <div class="docs-content-inner">{{ content }}</div>
    </article>
  </div>
</main>

<script type="text/javascript">
  document.querySelector('#menu-button').addEventListener('click', () => {
    document.querySelector('.docs-secondary-nav').classList.toggle('collapsed');
  });
</script>
